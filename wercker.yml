box: warfox/pandoc-debian

build:
  steps:
    - script:
        name: pandoc version
        code: pandoc --version
    - script:
        name: make html
        code: |
          make html

deploy:
    steps:
        - install-packages:
            packages: openssh-client
        - add-to-known_hosts:
            hostname: $HOSTNAME
        - mktemp:
            envvar: PRIVATEKEY_PATH
        - create-file:
            name: write key
            filename: $PRIVATEKEY_PATH
            content: $DEPLOY_PRIVATE
            overwrite: true
            hide-from-log: true
        - script:
            name: transfer files
            code: |
                pwd
                ls -la
                scp -i $PRIVATEKEY_PATH -o StrictHostKeyChecking=no -o UserKnownHostsFile=no -P $PORT -v -r dist/* $USER@$HOSTNAME:$DEPLOY_DIR
